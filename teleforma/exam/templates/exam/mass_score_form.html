{% extends "exam/scores.html" %}
{% load telemeta_utils %}
{% load teleforma_tags %}
{% load i18n %}
{% load thumbnail %}

{% block extra_javascript %}
{% if upload %}
  <script>
    $(document).ready(function(){
        $('#loading').hide();
    });

    $(function() {
        $('#submit_button').unbind('click').click(function() {
            $(window).unbind('beforeunload');
            // b2.unbind('click');
            $('#id_status').val("5");
            $('#id_period').val("{{ period.id }}");
            $(this).hide();
            $('#loading').show();
            $('#_ScriptForm').submit();
        });
    });
    </script>
{% endif %}
{% endblock extra_javascript %}

{% block answers %}

<div class="course_title">
  Saisie en masse de notes
</div>
<br />

{% if messages %}
    <div class="messages">
        {% for message in messages %}
          <div{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</div>
        {% endfor %}
    </div>
{% endif %}

<div class="course_content" id="media_infos" style="font-size: 115%;">
    <form method="post" id="_ScriptForm" action="" enctype="multipart/form-data" data-ajax="false">{% csrf_token %}
       <table>
       <br />
       <tr><td colspan="2">{% for error in form.non_field_errors %}<li class="error">{{ error }}</li>{% endfor %}</td></tr>
       {% for field in form %}
       <tr>
        {% if not field.html_name in create_fields %}
            <td>{{ field.label_tag.as_hidden }}</td><td>{{ field.as_hidden }}</td>
        {% else %}
        <td>
          {{ field.label_tag }}:
        </td>
        <td>
          {{ field }}
        </td>
        <td>
          {% for error in field.errors %}
          <div class="error">
            {{ error|escape }}
          </div>
          {% endfor %}          
        </td>
        {% endif %}
        </tr>
       {% endfor %}
       </table>

       <table>
         <thead>
           <tr>
             <th>Ã‰tudiant</th>
             <th>Note</th>
           </tr>
         </thead>
         <tbody>
           {% for row in rows %}
           <tr>
             <td>
               <input name="{{ row.student_name }}" value="{{ row.student_value }}" />
             </td>
             <td>
               <input name="{{ row.score_name }}" value="{{ row.score_value }}" />
             </td>
             {% if row.error %}
             <td>
               <div class="error">
                 {{ row.error }}
               </div>
             </td>
             {% endif %}
           </tr>
           {% endfor %}
         </tbody>
       </table>
    </form>
    {% if upload %}
    <br />
    <center>
    <a href="#" id="submit_button" class="component_icon button icon_next">{% trans "Submit" %}</a>
    <img id="loading" src="/static/teleforma/images/loading.gif" style="vertical-align:middle" alt="loading" />
    </center>
    {% endif %}
    <br /><br />

</div>
</div>

{% endblock answers %}
